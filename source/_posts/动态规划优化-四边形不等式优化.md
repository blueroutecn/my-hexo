---
mathjax: true
title: <动态规划优化> 四边形不等式优化
date: 2015-07-19 15:34:44
categories: ACM动态规划
tags: [动态规划]
---

## 问题类型

动态规划优化

##	问题描述

在动态规划中，有这样一类问题，状态转移方程为：
$$
dp[i][j] =
	\left\\{
		\begin{matrix}
			0, i=j \\\\
			min\{dp[i][k-1]+dp[k][j]\}+w[i][j], k>i\ and\ k \leq j 
		\end{matrix}
	\right.
$$
在没有经过优化的情况下，该问题的求解时间复杂度为O(n^3)。

##	优化方法

有如下定义和定理：

*	<b>定义1</b>&nbsp;如果一个函数w[i][j]，满足$w[i][j] + w[i'][j'] \leq w[i][j'] + w[i'][j], i \leq i' \leq j \leq j'$则称w满足凸四边形不等式。
*	<b>定义2</b>&nbsp;如果一个函数w[i][j]，满足$w[i'][j] \leq w[i][j'], i \leq i' \leq j \leq j'$则称w关于区间包含关系单调。
*	<b>定理1</b>&nbsp;w为凸，当且仅当$w[i][j] + w[i + 1][j + 1] \leq w[i + 1][j] + w[i][j + 1]$
*	<b>定理2</b>&nbsp;如果w同时满足四边形不等式和区间单调关系，则dp函数也满足四边形不等式。
*	<b>定理3</b>&nbsp;如果定理2的条件满足，设当dp[i][j]取得最小值时的k为k[i][j]，则$k[i][j-1] \leq k[i][j] \leq k[i+1][j]$
	
对以上定义和定理进行以下几点说明：

*	定理1告诉我们验证w是否为凸函数的方法，就是固定变量j，判断$w[i][j+1]-w[i][j]$是否随着i的增加而非递减。
*	通过定理3，我们知道决策具有单调性，我们可以以此来缩小决策的枚举范围。
*	实际操作中，不需要证明函数是否满足性质，只要打表观察就好，如w函数是否满足四边形不等式、w函数是否单调，决策函数k是否满足定理3中的不等式等。
	
根据以上性质，我们得出结论：求k[i][j]的时候只和k[i+1][j]和k[i][j-1]有关，所以可以按照i递减、j递增的顺序递推求解dp数组的各个值，得到最终结果，时间复杂度从O(n^3)降到了O(n^2)。

